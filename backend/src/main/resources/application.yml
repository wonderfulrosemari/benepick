spring:
  application:
    name: benepick-backend
  config:
    import:
      - optional:file:./config/secrets.properties
      - optional:file:./config/secrets-local.properties
  datasource:
    url: ${DB_URL:jdbc:postgresql://localhost:5432/benepick}
    username: ${DB_USERNAME:${USER:postgres}}
    password: ${DB_PASSWORD:}
  jpa:
    open-in-view: false
    hibernate:
      ddl-auto: update
    properties:
      hibernate:
        format_sql: true
  jackson:
    default-property-inclusion: non_null

server:
  port: ${SERVER_PORT:8080}

auth:
  jwt:
    secret: ${JWT_SECRET:change-this-secret-key-to-at-least-32-bytes-benepick}
    access-token-minutes: ${JWT_ACCESS_MINUTES:15}
    refresh-token-days: ${JWT_REFRESH_DAYS:30}
    issuer: ${JWT_ISSUER:benepick}
  cookie:
    name: ${REFRESH_COOKIE_NAME:refresh_token}
    secure: ${REFRESH_COOKIE_SECURE:false}
    same-site: ${REFRESH_COOKIE_SAMESITE:Lax}
    domain: ${REFRESH_COOKIE_DOMAIN:}
  google:
    client-id: ${GOOGLE_CLIENT_ID:}
    jwk-set-uri: ${GOOGLE_JWK_SET_URI:https://www.googleapis.com/oauth2/v3/certs}

app:
  cors:
    allowed-origins:
      - ${FRONTEND_ORIGIN:http://localhost:5173}

catalog:
  product-url-overrides:
    path: ${CATALOG_PRODUCT_URL_OVERRIDES_PATH:./config/product-url-overrides.properties}
  finlife:
    base-url: ${FINLIFE_BASE_URL:https://finlife.fss.or.kr/finlifeapi}
    auth-key: ${FINLIFE_AUTH_KEY:}
    top-fin-grp-nos:
      - ${FINLIFE_TOP_FIN_GRP_NO:020000}
    max-pages-per-group: ${FINLIFE_MAX_PAGES_PER_GROUP:2}
    connect-timeout-ms: ${FINLIFE_CONNECT_TIMEOUT_MS:5000}
    read-timeout-ms: ${FINLIFE_READ_TIMEOUT_MS:12000}
  card-external:
    mode: ${CARD_EXTERNAL_MODE:source}
    source-url: ${CARD_EXTERNAL_SOURCE_URL:}
    connect-timeout-ms: ${CARD_EXTERNAL_CONNECT_TIMEOUT_MS:4000}
    read-timeout-ms: ${CARD_EXTERNAL_READ_TIMEOUT_MS:10000}
    public-data:
      url: ${CARD_PUBLIC_DATA_URL:}
      service-key: ${CARD_PUBLIC_DATA_SERVICE_KEY:}
      service-key-param: ${CARD_PUBLIC_DATA_SERVICE_KEY_PARAM:serviceKey}
      page-no: ${CARD_PUBLIC_DATA_PAGE_NO:1}
      num-of-rows: ${CARD_PUBLIC_DATA_NUM_OF_ROWS:200}
      extra-query: ${CARD_PUBLIC_DATA_EXTRA_QUERY:}
      items-path: ${CARD_PUBLIC_DATA_ITEMS_PATH:}
      force-json: ${CARD_PUBLIC_DATA_FORCE_JSON:true}
      default-provider-name: ${CARD_PUBLIC_DATA_DEFAULT_PROVIDER_NAME:}
      official-url-fallback: ${CARD_PUBLIC_DATA_OFFICIAL_URL_FALLBACK:}
      default-tags: ${CARD_PUBLIC_DATA_DEFAULT_TAGS:external}
      default-categories: ${CARD_PUBLIC_DATA_DEFAULT_CATEGORIES:}
    public-data-all:
      service-key: ${CARD_PUBLIC_ALL_SERVICE_KEY:}
      include-kdb: ${CARD_PUBLIC_ALL_INCLUDE_KDB:true}
      include-krpost: ${CARD_PUBLIC_ALL_INCLUDE_KRPOST:true}
      include-finance-stats: ${CARD_PUBLIC_ALL_INCLUDE_FINANCE_STATS:false}
      kdb:
        url: ${CARD_PUBLIC_ALL_KDB_URL:https://apis.data.go.kr/B190030/GetCardProductInfoService/getCardProductList}
        page-no: ${CARD_PUBLIC_ALL_KDB_PAGE_NO:1}
        num-of-rows: ${CARD_PUBLIC_ALL_KDB_NUM_OF_ROWS:500}
        max-pages: ${CARD_PUBLIC_ALL_KDB_MAX_PAGES:20}
        start-date: ${CARD_PUBLIC_ALL_KDB_START_DATE:20210101}
        end-date: ${CARD_PUBLIC_ALL_KDB_END_DATE:20991231}
        force-json: ${CARD_PUBLIC_ALL_KDB_FORCE_JSON:true}
        items-path: ${CARD_PUBLIC_ALL_KDB_ITEMS_PATH:response.body.items.item}
        default-provider-name: ${CARD_PUBLIC_ALL_KDB_PROVIDER:한국산업은행}
        official-url-fallback: ${CARD_PUBLIC_ALL_KDB_URL_FALLBACK:https://www.kdb.co.kr}
      krpost:
        url: ${CARD_PUBLIC_ALL_KRPOST_URL:https://apis.data.go.kr/1721301/KrpostCardProductView/CheckcardGoods}
        page-no: ${CARD_PUBLIC_ALL_KRPOST_PAGE_NO:1}
        num-of-rows: ${CARD_PUBLIC_ALL_KRPOST_NUM_OF_ROWS:200}
        max-pages: ${CARD_PUBLIC_ALL_KRPOST_MAX_PAGES:20}
        product-name-keyword: ${CARD_PUBLIC_ALL_KRPOST_PRODUCT_NAME:카드}
        items-path: ${CARD_PUBLIC_ALL_KRPOST_ITEMS_PATH:response.body.items.item}
        default-provider-name: ${CARD_PUBLIC_ALL_KRPOST_PROVIDER:우체국}
        official-url-fallback: ${CARD_PUBLIC_ALL_KRPOST_URL_FALLBACK:https://www.epostbank.go.kr}
      finance-stats:
        url: ${CARD_PUBLIC_ALL_FIN_STATS_URL:https://apis.data.go.kr/1160100/service/GetCredCardCompInfoService/getCredCardCompGeneInfo}
        page-no: ${CARD_PUBLIC_ALL_FIN_STATS_PAGE_NO:1}
        num-of-rows: ${CARD_PUBLIC_ALL_FIN_STATS_NUM_OF_ROWS:500}
        max-pages: ${CARD_PUBLIC_ALL_FIN_STATS_MAX_PAGES:20}
        title: ${CARD_PUBLIC_ALL_FIN_STATS_TITLE:신용카드_일반현황_임직원현황}
        base-year-month: ${CARD_PUBLIC_ALL_FIN_STATS_BASYM:}
        result-type: ${CARD_PUBLIC_ALL_FIN_STATS_RESULT_TYPE:json}
        items-path: ${CARD_PUBLIC_ALL_FIN_STATS_ITEMS_PATH:response.body.tableList[0].items.item}
        default-provider-name: ${CARD_PUBLIC_ALL_FIN_STATS_PROVIDER:신용카드사}
        official-url-fallback: ${CARD_PUBLIC_ALL_FIN_STATS_URL_FALLBACK:https://www.fsc.go.kr}

  sync:
    enabled: ${CATALOG_SYNC_ENABLED:true}
    startup-enabled: ${CATALOG_SYNC_STARTUP_ENABLED:true}
    scheduled-enabled: ${CATALOG_SYNC_SCHEDULED_ENABLED:true}
    finlife-enabled: ${CATALOG_SYNC_FINLIFE_ENABLED:true}
    cards-enabled: ${CATALOG_SYNC_CARDS_ENABLED:true}
    cron: ${CATALOG_SYNC_CRON:0 30 3 * * *}
    zone: ${CATALOG_SYNC_ZONE:Asia/Seoul}

recommendation:
  scoring:
    profile: ${REC_SCORING_PROFILE:balanced}
    account:
      base-score: ${REC_SCORE_ACCOUNT_BASE:45}
      salary-transfer-weight: ${REC_SCORE_ACCOUNT_SALARY:30}
      travel-often-global-weight: ${REC_SCORE_ACCOUNT_TRAVEL_OFTEN:28}
      young-weight: ${REC_SCORE_ACCOUNT_YOUNG:18}
      daily-spend-weight: ${REC_SCORE_ACCOUNT_DAILY:10}
      intent-category-hit-weight: ${REC_SCORE_ACCOUNT_INTENT_HIT:6}
      priority-savings-weight: ${REC_SCORE_ACCOUNT_PRIORITY_SAVINGS:34}
      priority-starter-weight: ${REC_SCORE_ACCOUNT_PRIORITY_STARTER:24}
      priority-travel-weight: ${REC_SCORE_ACCOUNT_PRIORITY_TRAVEL:22}
      priority-cashback-weight: ${REC_SCORE_ACCOUNT_PRIORITY_CASHBACK:14}
      high-rate-bonus-weight: ${REC_SCORE_ACCOUNT_HIGH_RATE_BONUS:8}
      young-age-max: ${REC_SCORE_ACCOUNT_YOUNG_MAX:34}
      daily-spend-threshold: ${REC_SCORE_ACCOUNT_DAILY_THRESHOLD:100}
      high-rate-threshold: ${REC_SCORE_ACCOUNT_HIGH_RATE_THRESHOLD:3.5}
    card:
      base-score: ${REC_SCORE_CARD_BASE:45}
      category-hit-weight: ${REC_SCORE_CARD_CATEGORY_HIT:9}
      priority-cashback-weight: ${REC_SCORE_CARD_PRIORITY_CASHBACK:24}
      priority-travel-weight: ${REC_SCORE_CARD_PRIORITY_TRAVEL:22}
      priority-starter-weight: ${REC_SCORE_CARD_PRIORITY_STARTER:24}
      priority-savings-weight: ${REC_SCORE_CARD_PRIORITY_SAVINGS:14}
      travel-often-weight: ${REC_SCORE_CARD_TRAVEL_OFTEN:28}
      daily-spend-weight: ${REC_SCORE_CARD_DAILY:10}
      low-annual-fee-bonus-weight: ${REC_SCORE_CARD_LOW_FEE_BONUS:8}
      high-annual-fee-penalty-weight: ${REC_SCORE_CARD_HIGH_FEE_PENALTY:6}
      daily-spend-threshold: ${REC_SCORE_CARD_DAILY_THRESHOLD:80}
      high-annual-fee-threshold-won: ${REC_SCORE_CARD_HIGH_FEE_THRESHOLD_WON:20000}
  quality:
    enabled: ${REC_QUALITY_ENABLED:true}
    startup-enabled: ${REC_QUALITY_STARTUP_ENABLED:true}
    scheduled-enabled: ${REC_QUALITY_SCHEDULED_ENABLED:true}
    cron: ${REC_QUALITY_CRON:0 10 4 * * *}
    zone: ${REC_QUALITY_ZONE:Asia/Seoul}
    window-days: ${REC_QUALITY_WINDOW_DAYS:14}
    min-recommended-products: ${REC_QUALITY_MIN_RECOMMENDED:20}
    low-ctr-percent: ${REC_QUALITY_LOW_CTR:5}
    high-ctr-percent: ${REC_QUALITY_HIGH_CTR:18}
    low-cvr-percent: ${REC_QUALITY_LOW_CVR:3}
    high-cvr-percent: ${REC_QUALITY_HIGH_CVR:12}
    max-weight-adjustment-percent: ${REC_QUALITY_MAX_WEIGHT_DELTA:20}
